<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: boardCore.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: boardCore.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// @ts-check
/* global firebase */ // (nur für Konsistenz, hier ungenutzt)
/// &lt;reference path="./boardTypesD.ts" />

/**
 * Board.Core – gemeinsame UI-/Form-Utilities für die Board-Seiten.
 * Export: `window.Board.Core`
 */
(function (w) {
  /** @type {any} */ const Win = w;
  Win.Board = Win.Board || {};

  // ────────────────────────────────────────────────────────── CSS Snippets
  const VALIDATION_CSS = `
    .field-invalid{border:2px solid #E74C3C!important;background:#fffafa;}
    .form-group .field-hint{display:none;color:#E74C3C;font-size:.9rem;}
    .form-group .field-hint.show{display:block;}
  `;
  const TOAST_CSS = `
    @keyframes boardToastIn{0%{top:100%;transform:translate(-50%,0)}100%{top:50%;transform:translate(-50%,-50%)}}
    @keyframes boardToastOut{0%{top:50%;transform:translate(-50%,-50%)}100%{top:100%;transform:translate(-50%,0);opacity:0}}
    #boardAddToast{position:fixed;left:50%;top:100%;transform:translate(-50%,0);z-index:99999;background:transparent;pointer-events:none}
    #boardAddToast img{display:block;width:300px;height:auto}
    #boardAddToast.enter{animation:boardToastIn .55s cubic-bezier(.2,.8,.2,1) forwards}
    #boardAddToast.leave{animation:boardToastOut .5s ease forwards}
  `;

  // ────────────────────────────────────────────────────────── Small helpers
  /**
   * Style-Block mit ID sicherstellen.
   * @param {string} id
   * @param {string} css
   * @returns {HTMLStyleElement}
   */
  function ensureStyle(id, css) {
    let s = /** @type {HTMLStyleElement|null} */ (document.getElementById(id));
    if (!s) { s = document.createElement('style'); s.id = id; document.head.appendChild(s); }
    s.textContent = css; return s;
  }

  /**
   * Erstellt (falls nötig) das Toast-Element.
   * @returns {HTMLElement}
   */
  function ensureToastEl() {
    let el = document.getElementById('boardAddToast');
    if (!el) { el = document.createElement('div'); el.id = 'boardAddToast'; el.innerHTML = `&lt;img src="../assets/icons/add_task/board_white.png" alt="">`; document.body.appendChild(el); }
    return el;
  }

  /**
   * CSS-Animation neu triggern (Klasse entfernen/erzwingen/hinzufügen).
   * @param {HTMLElement} el
   * @param {string[]} remove
   * @param {string} add
   */
  function retriggerAnim(el, remove, add) {
    remove.forEach(c => el.classList.remove(c));
    // @ts-ignore – Reflow erzwingen
    void el.offsetWidth;
    el.classList.add(add);
  }

  // ────────────────────────────────────────────────────────── Styles / Validation
  /**
   * Minimal-Styles für Custom-Validation injizieren.
   * @returns {void}
   */
  function ensureValidationStyles() { ensureStyle('custom-validation-styles', VALIDATION_CSS); }

  /**
   * HTML-Escaping für Nutzereingaben (XSS-Schutz).
   * @param {any} s
   * @returns {string}
   */
  const escapeHtml = (s) =>
    String(s).replace(/[&amp;&lt;>"']/g, c => ({ '&amp;':'&amp;amp;','&lt;':'&amp;lt;','>':'&amp;gt;','"':'&amp;quot;',"'":'&amp;#39;' }[c]));

  /**
   * Heutiges Datum (lokale TZ) als `YYYY-MM-DD`.
   * @returns {string}
   */
  const todayLocalISO = () => { const off = new Date().getTimezoneOffset() * 60000; return new Date(Date.now() - off).toISOString().slice(0,10); };

  /**
   * Setzt `min`-Attribut eines Date-Inputs auf „heute“.
   * @param {string} selector
   * @returns {void}
   */
  function setDateMinToday(selector) {
    const el = /** @type {HTMLElement|null} */ (document.querySelector(selector));
    if (el) el.setAttribute('min', todayLocalISO());
  }

  /**
   * Nächstliegende `.form-group` holen (Fallback: Parent).
   * @param {HTMLElement | null | undefined} el
   * @returns {HTMLElement | null}
   */
  const getFormGroup = (el) =>
    (el &amp;&amp; ('closest' in el) ? /** @type {HTMLElement|null} */ (el.closest('.form-group')) : null) ||
    (el ? /** @type {HTMLElement|null} */ (el.parentElement) : null);

  /**
   * `.field-hint` unterhalb der `.form-group` sicherstellen.
   * @param {HTMLElement | null | undefined} el
   * @returns {HTMLElement | null}
   */
  function ensureHintFor(el) {
    const grp = getFormGroup(el); if (!grp) return null;
    let hint = /** @type {HTMLElement|null} */ (grp.querySelector('.field-hint'));
    if (!hint) { hint = document.createElement('small'); hint.className = 'field-hint'; hint.textContent = 'This field is required'; grp.appendChild(hint); }
    return hint;
  }

  /**
   * Feld als invalid markieren (Border, aria, Hint).
   * @param {HTMLElement | null | undefined} el
   * @returns {void}
   */
  function markInvalid(el) {
    if (!el) return;
    el.classList.add('field-invalid'); el.setAttribute('aria-invalid','true');
    ensureHintFor(el)?.classList.add('show');
  }

  /**
   * Invalid-UI entfernen.
   * @param {HTMLElement | null | undefined} el
   * @returns {void}
   */
  function clearInvalidUI(el) {
    if (!el) return;
    el.classList.remove('field-invalid'); el.removeAttribute('aria-invalid');
    getFormGroup(el)?.querySelector('.field-hint')?.classList.remove('show');
  }

  // ────────────────────────────────────────────────────────── Toast
  /** Persistenter Timer für den Board-Toast. */
  let boardToastTimer = /** @type {number | undefined} */ (undefined);

  /**
   * Zeigt einen bildbasierten Slide-Toast (Board).
   * @returns {void}
   */
  function showBoardAddToast() {
    ensureStyle('board-add-toast-style', TOAST_CSS);
    const el = ensureToastEl();
    retriggerAnim(el, ['leave','enter'], 'enter');
    if (boardToastTimer) clearTimeout(boardToastTimer);
    boardToastTimer = window.setTimeout(() => {
      el.classList.remove('enter'); el.classList.add('leave');
      el.addEventListener('animationend', () => el.remove(), { once: true });
    }, 1200);
  }

  // ────────────────────────────────────────────────────────── Error dialog
  /**
   * Zentraler Fehlerdialog (Fallback: alert).
   * @param {string} message
   * @returns {void}
   */
  function showErrorDialog(message) {
    const dlg = document.getElementById('errorDialog');
    if (dlg instanceof HTMLDialogElement) {
      const p = dlg.querySelector('p'); if (p) p.textContent = message;
      if (!dlg.open) dlg.showModal();
    } else { alert(message); }
  }

  // ────────────────────────────────────────────────────────── Export
  Win.Board.Core = {
    ensureValidationStyles,
    escapeHtml,
    todayLocalISO,
    setDateMinToday,
    getFormGroup,
    ensureHintFor,
    markInvalid,
    clearInvalidUI,
    showBoardAddToast,
    showErrorDialog,
  };
})(window);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addContactLocally">addContactLocally</a></li><li><a href="global.html#addContacts">addContacts</a></li><li><a href="global.html#addNewContact">addNewContact</a></li><li><a href="global.html#addUsers">addUsers</a></li><li><a href="global.html#allInputsValid">allInputsValid</a></li><li><a href="global.html#animateContactDetails">animateContactDetails</a></li><li><a href="global.html#animateOverlayOut">animateOverlayOut</a></li><li><a href="global.html#checkLoadingScreen">checkLoadingScreen</a></li><li><a href="global.html#clearAddContactInputs">clearAddContactInputs</a></li><li><a href="global.html#clearTaskAssignment">clearTaskAssignment</a></li><li><a href="global.html#closeContactOptions">closeContactOptions</a></li><li><a href="global.html#closeOverlay">closeOverlay</a></li><li><a href="global.html#collectUpdatedFormData">collectUpdatedFormData</a></li><li><a href="global.html#confirmLockIcon">confirmLockIcon</a></li><li><a href="global.html#createContactGroup">createContactGroup</a></li><li><a href="global.html#createDivider">createDivider</a></li><li><a href="global.html#createInitialIcon">createInitialIcon</a></li><li><a href="global.html#createSuccessOverlay">createSuccessOverlay</a></li><li><a href="global.html#deleteContact">deleteContact</a></li><li><a href="global.html#deleteContactFromEdit">deleteContactFromEdit</a></li><li><a href="global.html#deleteContactFromEditMobile">deleteContactFromEditMobile</a></li><li><a href="global.html#deleteContactFromFirebase">deleteContactFromFirebase</a></li><li><a href="global.html#deleteData">deleteData</a></li><li><a href="global.html#deleteMobileContact">deleteMobileContact</a></li><li><a href="global.html#doPasswordsMatch">doPasswordsMatch</a></li><li><a href="global.html#editContact">editContact</a></li><li><a href="global.html#editMobileContact">editMobileContact</a></li><li><a href="global.html#editOverlayDesktop">editOverlayDesktop</a></li><li><a href="global.html#editOverlayLogic">editOverlayLogic</a></li><li><a href="global.html#editOverlayMobile">editOverlayMobile</a></li><li><a href="global.html#editValidationInitialized">editValidationInitialized</a></li><li><a href="global.html#ensureOwnContactInList">ensureOwnContactInList</a></li><li><a href="global.html#errorMsgs">errorMsgs</a></li><li><a href="global.html#fillEditForm">fillEditForm</a></li><li><a href="global.html#finalizeContactDeletion">finalizeContactDeletion</a></li><li><a href="global.html#focusOnNewContact">focusOnNewContact</a></li><li><a href="global.html#getColorFromName">getColorFromName</a></li><li><a href="global.html#getContactById">getContactById</a></li><li><a href="global.html#getContactDetailsTemplate">getContactDetailsTemplate</a></li><li><a href="global.html#getContactTemplateByData">getContactTemplateByData</a></li><li><a href="global.html#getErrorMessages">getErrorMessages</a></li><li><a href="global.html#getFormData">getFormData</a></li><li><a href="global.html#getInitials">getInitials</a></li><li><a href="global.html#getRegexes">getRegexes</a></li><li><a href="global.html#goBack">goBack</a></li><li><a href="global.html#groupContactsByInitial">groupContactsByInitial</a></li><li><a href="global.html#handleContactClick">handleContactClick</a></li><li><a href="global.html#hideContactDetails">hideContactDetails</a></li><li><a href="global.html#highlightAndScrollTo">highlightAndScrollTo</a></li><li><a href="global.html#isEmailValid">isEmailValid</a></li><li><a href="global.html#isOwnContact">isOwnContact</a></li><li><a href="global.html#isPasswordValid">isPasswordValid</a></li><li><a href="global.html#loadAllTasksFromFirebase">loadAllTasksFromFirebase</a></li><li><a href="global.html#loadData">loadData</a></li><li><a href="global.html#logOutUser">logOutUser</a></li><li><a href="global.html#nameValidation">nameValidation</a></li><li><a href="global.html#onloadFunction">onloadFunction</a></li><li><a href="global.html#openContactOptions">openContactOptions</a></li><li><a href="global.html#openContactOverview">openContactOverview</a></li><li><a href="global.html#openOverlay">openOverlay</a></li><li><a href="global.html#outsideOverlayClick">outsideOverlayClick</a></li><li><a href="global.html#passwordLockIcon">passwordLockIcon</a></li><li><a href="global.html#passwordVisibility">passwordVisibility</a></li><li><a href="global.html#postData">postData</a></li><li><a href="global.html#prepareContactSwitch">prepareContactSwitch</a></li><li><a href="global.html#putData">putData</a></li><li><a href="global.html#regexes">regexes</a></li><li><a href="global.html#removeContactFromLocalArray">removeContactFromLocalArray</a></li><li><a href="global.html#removeIdFromTaskArray">removeIdFromTaskArray</a></li><li><a href="global.html#renderAllContacts">renderAllContacts</a></li><li><a href="global.html#renderContactDetails">renderContactDetails</a></li><li><a href="global.html#rerenderContactList">rerenderContactList</a></li><li><a href="global.html#resetContactOverview">resetContactOverview</a></li><li><a href="global.html#saveAsUser">saveAsUser</a></li><li><a href="global.html#saveContactToFirebase">saveContactToFirebase</a></li><li><a href="global.html#setCurrentUser">setCurrentUser</a></li><li><a href="global.html#setupEditValidation">setupEditValidation</a></li><li><a href="global.html#setupFormSubmit">setupFormSubmit</a></li><li><a href="global.html#setupInputListeners">setupInputListeners</a></li><li><a href="global.html#setupInputSanitizers">setupInputSanitizers</a></li><li><a href="global.html#setupSanitizers">setupSanitizers</a></li><li><a href="global.html#setupValidation">setupValidation</a></li><li><a href="global.html#setupValidationListeners">setupValidationListeners</a></li><li><a href="global.html#showDetails">showDetails</a></li><li><a href="global.html#showLoadingScreen">showLoadingScreen</a></li><li><a href="global.html#showOverlay">showOverlay</a></li><li><a href="global.html#showSuccessOverlay">showSuccessOverlay</a></li><li><a href="global.html#signUpUser">signUpUser</a></li><li><a href="global.html#submitSignUpForm">submitSignUpForm</a></li><li><a href="global.html#toggleSubmit">toggleSubmit</a></li><li><a href="global.html#toggleSubmitState">toggleSubmitState</a></li><li><a href="global.html#updateContactInFirebase">updateContactInFirebase</a></li><li><a href="global.html#updateFormStyles">updateFormStyles</a></li><li><a href="global.html#updateLocalContact">updateLocalContact</a></li><li><a href="global.html#updateTaskAssignedTo">updateTaskAssignedTo</a></li><li><a href="global.html#updateTasksAssignedToContact">updateTasksAssignedToContact</a></li><li><a href="global.html#userLogIn">userLogIn</a></li><li><a href="global.html#validateEmailInput">validateEmailInput</a></li><li><a href="global.html#validateForm">validateForm</a></li><li><a href="global.html#validateInput">validateInput</a></li><li><a href="global.html#validatePassword">validatePassword</a></li><li><a href="global.html#validateSpecificInput">validateSpecificInput</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sun Oct 05 2025 17:59:52 GMT+0200 (Mitteleuropäische Sommerzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
